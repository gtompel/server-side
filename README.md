# Приложение Data Table

## Обзор

Это приложение предоставляет многофункциональную таблицу данных с такими возможностями, как генерация данных, выбор строк, фильтрация, сортировка перетаскиванием, пагинация и сохранение состояния. Оно построено с использованием React на фронтенде и Node.js (Express) на бэкенде.

## Функциональности

- **Генерация тестовых данных**: Генерирует список тестовых значений от 1 до 1,000,000.
- **Выбор строк**:
  - Поддерживает выбор одной или нескольких строк с помощью чекбоксов.
  - Позволяет выбирать отдельные строки или все сразу.
- **Фильтрация**:
  - Реализует функцию поиска с поддержкой пагинации.
  - Сохраняет порядок сортировки во время фильтрации.
- **Сортировка перетаскиванием**:
  - Позволяет сортировать элементы перетаскиванием с использованием `@hello-pangea/dnd`.
  - Поддерживает изменение порядка элементов.
- **Сортировка отфильтрованных результатов**:
  - Сортирует отфильтрованные результаты на бэкенде с использованием функции `searchData`.
  - Применяет сортировку на основе `sortedOrder`.
- **Пагинация**:
  - Реализует пагинацию с 20 элементами на странице.
  - Использует `react-window` и `InfiniteLoader` для эффективного рендеринга.
  - Загружает данные при прокрутке.
- **Сохранение состояния**:
  - Сохраняет состояние между перезагрузками с использованием API endpoints `/api/selected` и `/api/sortorder`.
  - Восстанавливает состояние при загрузке страницы.
- **Хранение на сервере**:
  - Хранит выбранные элементы и порядок сортировки в памяти сервера с использованием переменных `selectedItems` и `sortedOrder`.
- **Пагинация в результатах поиска**:
  - Поддерживает пагинацию в результатах поиска с использованием API `searchData`.
  - Реализует `limit` и `offset` для постраничного получения данных.

## Детали реализации

### Фронтенд

- **TableRow.tsx & TableHeader.tsx**: Реализуют выбор строк с помощью чекбоксов, поддерживая выбор одной или нескольких строк, а также выбор всех строк.
- **SearchBar.tsx**: Реализует функцию поиска, обеспечивая ее бесперебойную работу с пагинацией и сохраняя текущий порядок сортировки.
- **react-window & InfiniteLoader**: Используются для эффективной пагинации, загружая 20 элементов на страницу и подгружая больше данных при прокрутке пользователем.
- **@hello-pangea/dnd**: Позволяет сортировать строки перетаскиванием в таблице.

### Бэкенд

- **server/index.js**:
  - `generateTestData()`: Генерирует тестовые данные.
  - `searchData(data, searchTerm, sortedOrder, limit, offset)`: Фильтрует данные на основе поискового запроса, применяет сортировку и реализует пагинацию с использованием `limit` и `offset`.
  - `/api/selected`: API endpoint для сохранения и получения выбранных элементов.
  - `/api/sortorder`: API endpoint для сохранения и получения порядка сортировки.
  - Хранение в памяти для `selectedItems` и `sortedOrder` для сохранения состояния на сервере.

## API Endpoints

- `/api/selected`:
  - `GET`: Получает список выбранных элементов.
  - `POST`: Обновляет список выбранных элементов.
- `/api/sortorder`:
  - `GET`: Получает текущий порядок сортировки.
  - `POST`: Обновляет порядок сортировки.
- `/api/data`:
  - `GET`: Получает данные с поддержкой пагинации, поиска и сортировки.

## Детали API поиска данных

API endpoint `searchData` в `server/index.js` поддерживает следующие параметры для эффективного получения данных:

- `data`: Полный набор данных для поиска.
- `searchTerm`: Поисковый запрос для фильтрации данных.
- `sortedOrder`: Порядок, в котором данные должны быть отсортированы.
- `limit`: Максимальное количество элементов для возврата на странице.
- `offset`: Индекс начального элемента для возврата (для пагинации).

Этот API обеспечивает правильную пагинацию результатов поиска и сохраняет желаемый порядок сортировки.